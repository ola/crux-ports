# Description: Low-latency language server supporting multi-million line C++ code-bases, powered by libclang.
# URL:         https://github.com/cquery-project/cquery/
# Maintainer:  Ola HÃ¥kansson <ola dot hakansson at gmail dot com>
# Depends on:  git python clang

name=cquery
version=20180215
release=1
source=(https://github.com/cquery-project/cquery/archive/v$version.tar.gz)

build() {
  cd $name-$version

  git clone https://github.com/miloyip/rapidjson third_party/rapidjson
  git clone https://github.com/onqtam/doctest third_party/doctest
  git clone https://github.com/greg7mdp/sparsepp third_party/sparsepp
  git clone https://github.com/emilk/loguru third_party/loguru
  git clone https://github.com/msgpack/msgpack-c third_party/msgpack-c

  mkdir -p $PKG/usr/bin

  python waf configure --prefix=$PKG/usr --llvm-config=`which llvm-config` --variant=release
  python waf build --variant=release
  python waf install --prefix=$PKG/usr
}

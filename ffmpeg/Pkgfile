# Description: Complete solution to record, convert and stream audio and video.
# URL: http://ffmpeg.org/
# Maintainer: Danny Rawlins, crux at romster dot me
# Packager: Matt Housh, jaeger at crux dot nu
# Depends on: gnutls lame libgmp libsdl libtheora libva libvpx libxvid opencore-amr openjpeg opus rtmpdump schroedinger speex x264 x265

name=ffmpeg
version=3.1.5
release=1
source=(http://ffmpeg.org/releases/$name-$version.tar.bz2
        ffmpeg-x264-10bit.sh)

build() {
	cd $name-$version

  ./configure \
    --prefix=/usr \
    --disable-debug \
    --disable-doc \
    --enable-avfilter \
    --enable-avresample \
    --enable-dxva2 \
    --enable-fontconfig \
    --enable-gcrypt \
    --enable-gmp \
    --enable-gnutls \
    --enable-gpl \
    --enable-libfreetype \
    --enable-libmp3lame \
    --enable-libopencore_amrnb \
    --enable-libopencore_amrwb \
    --enable-libopenjpeg \
    --enable-libopus \
    --enable-librtmp \
    --enable-libschroedinger \
    --enable-libspeex \
    --enable-libtheora \
    --enable-libvorbis \
    --enable-libx264 \
    --enable-libx265 \
    --enable-libvpx \
    --enable-libxvid \
    --enable-pic \
    --enable-postproc \
    --enable-pthreads \
    --enable-shared \
    --enable-swresample \
    --enable-vaapi \
    --enable-vdpau \
    --enable-version3 \
    --enable-x11grab \
    --enable-openal

  [ "$CC" ] || CC=gcc
  make CC="$CC" SHARED_PP='yes' $MAKEFLAGS
  make DESTDIR=$PKG install install-man

  install -m 0755 -D $SRC/ffmpeg-x264-10bit.sh $PKG/usr/bin/ffmpeg-x264-10bit
}
